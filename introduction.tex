\chapter{Introduction}


\iffalse Brief outline of the chapter below

Background:
	What is HH equation?
	What does it model?
	How is it derived?
	Boundary conditions
	- 	Sommerfield radiation condition
	
Finite element method:
	Discretisation of HH
	Discretisation of infinite domains
		D,N,radiation
	ABC, DtN, PML

Linear solvers:
	Iterative and direct
	Krylov methods
	Preconditioners
	How does this relate to Poisson and HH?
	- 	Small wavenumbers good convergence

Project direction:
	Where are we going? What to do...?
	Multigrid in non-cartesian coordinates
	Fourier decompostion of HH
	Explore implementation of PMLs
\fi


% ----------------------------------------------

% \section{Preliminaries}

The equation of interest in this project is the Helmholtz partial differential equation.
More specifically, we will focus on the Helmholtz equation in circular cylindrical coordinates and decomposed into Fourier modes in the azimuthal direction,
\begin{equation}
	\nabla^2 u(r,z) + \left(k^2-\frac{N^2}{r^2}\right) u(r,z).
\end{equation}
This equation appears when seeking separable solutions by separating the time and space variables in the wave equation.
As such, it can be thought of as the steady-state of time-indepedent solution of the wave equation.
We will examine this equation mathematically, and discuss the difficulties in finding a solution numerically.

Along with the 
Because the problem is defined on an infinite domain, we must truncate the domain to find the solution numerically.
This causes a problem with the waves interacting with the boundary of the domain, which produces spurious reflections and the resulting solution to become meaningless.
It is possible to deal with these reflections by introducing an artifical absorbing layer to the boundary of the domain.
Several such layers exist, including absorbing boundary conditions (ABCs); Dirichlet-to-Neumann condtions (DtNs); and perfectly matched layers (PMLs).

In order to solve the problem, we will use the C++ library \oomph to find the solution using the finite element method.
This process will involve the discretisation of the equations on each element of the domain with the resulting system being assembled.
The result of the finite element discretisation is an $n\times n$ linear system of equations,
\[
	A u = f,
\]
which requires a solver in order to compute the solution.
In \oomph, the default linear solver is SuperLU, however this is also a direct solver.
This has the benefit that the computed solution to the above equation is exact, modulo any floating point errors.
But the computational cost is prohibitively expensive as the size of the problem increases.

For small $A$, it is possible to use direct methods to solve these exactly (in exact arithmetic).
As is often the case in practice, the matrices from the finite element discretisation are too large to compute by direct methods.
Instead, many iterative methods have been developed to approximate the solution instead.
A particular class of methods, Krylov subspace methods, form the solution by building iterates from elements in a space composed of successive powers of the matrix $A$ \cite{leveque}.
The Krylov space of dimension $k$ is 
\[
	\mathcal{K}_k(A, r_0) = \mathrm{span}(r_0, Ar_0, A^2 r_0, \ldots, A^{k-1} r_0).
\]
For example, the conjugate gradient method forms an orthogonal basis consisting of search directions.
Unfortunately, a restriction on the convergence of the CG algorithm is that the matrix $A$ must be symmetric and positive definite.
This is often not the case for a general problem.

% REWORD THIS PARAGRAPH
Understanding that Krylov methods act on certain parts of the spectrum of the residual to dampen a range of frequencies is the key idea in multigrid methods.
Transferring the residual of an equation on to a mesh with a different resolution can shift the frequency of the error in the residual.
This allows the Krylov method, in this context known as a \textit{smoother}, to dampen the whole spectrum of the error, resulting in rapid convergnce.

The performance of multigrid methods is excellent for the related Poisson problem,
\begin{equation}
	\nabla^2 u = 0.
\end{equation}
Indeed, it is an optimal solver with time-complexity of $O(n)$ for a problem of size $n\times n$.
For sufficiently small values of $k$, the Helmholtz equation is well approximated by Poisson's equation.
In addition, the matrix arising from the finite element discretisation is well-conditioned.
As $k$ becomes larger, however, the matrix becomes indefinite and more and more ill-conditioned.
This causes multigrid to fail to converge to a solution.
To handle the ill-conditioned system, a preconditioner can be used so that the problem may be more easily solved by numerical methods.

The multigrid solver for the Helmholtz equation exists for the equation in Cartesian coordinates in \oomph.
We would like to explore the performance of the solver for the Fourier decomposed version of the Helmholtz equation in axisymmetric cylindrical coordinates.
Following this, we will also examine the performance of the solver using PMLs to handle reflections on the discretised boundary.



% ----------------------------------------------

\section{Historical background}

\iffalse
Motivation.
Who cares? Why is it difficult?
What are the benefits?
Need some citations? Names in the field...
\fi



Because of the fundamental nature of waves, the wave equation has widespread application and appears in several contexts in science, engineering, and industry.
For example, in electromagnetics, Maxwell's equations describe the physical properties of waves generated from electric and magnetic fields.
In acoustics, the propagation of sound waves may be modelled by the same equations.
Also, modelling of seismic waves can help to better understand earthquakes and aid in the search for materials or objects underground.
Understanding and modelling scattering of waves is of great importance and practical use.

<<CITATION>>
Work in the field of waves began as early as with d'Alembert and Euler in the middle of the 18$^\text{th}$ century.
The motivation behind these ideas was the development of optics and the propagation of light.
This in turn led to the invention of telescopes and microscopes and paved the road for further scientific discovery.

The work in this project will primarily focus on the related partial differential equation, the Helmholtz equation.
The wave and Helmholtz equations are closely linked, and study of one can lead to insight in the other.
When seeking separable solutions of the wave equation, the Helmholtz equation appears as a time-independent form of the wave equation.
The solutions of the time-independent equation represent steady state solutions.

The specific problem 



% ----------------------------------------------

\section{Literature Review}

\iffalse

Topics to cover:
	Solving Poisson problem
	Solving Helmholtz
	Complex shifted laplacian
	Multigrid
	Cylindrical coordinates

Mention one or two references for each, try and reach >2 pages.

\fi

Let us discuss the current state of the literature in relation to our problems.

\subsection{Multigrid}

Wesseling \cite{wesseling} describes the historical development of multigrid methods up to 1985
It is also stated that the first mention of multigrid was by the Russian mathematician Fedorenko \cite{fedorenko}.
In his paper, a method for solving elliptic type equations which he called the ``the method of alternating direction''.
Later, Hackbusch independently discovered multigrid
the year in which Hackbusch \cite{hackbusch} released his seminal book with a full treatment of multigrid methods.


% Should we include this?
More recent work on multigrid consisted of the development of algebraic multigrid (AMG) methods.
These consist of decoupling the geometry of the problem from any operators involved in the iteration.
This allows for more complex problems wherein there may not be a sense of a geometry for the problem.
The method seeks to smooth errors in some algebraic sense, rather than geometrically \cite{}.% CITATION NEEDED

Since multigrid was developed in order to find solutions to elliptic problems, the majority of work has been focused in that area.7
As the prototypical example of an elliptic PDE is Poisson's equation, we can be certain that the mathematical framework for solving this is set.
The difficulty lies with the Helmholtz equation, which can be thought of a perturbation by $k^2$ of the Laplace operator in the Poisson equation.
As both the Poisson and Helmholtz equations are both of elliptic type, we should expect behaviour to be similar.
However, this is not the case.

Complex-shifted laplacian 
References 5,6
https://arxiv.org/pdf/1312.2880.pdf






% -----------------------------------------------

\section{Project outline}

\iffalse
What is each chapter doing? What do we hope to accomplish? 
This entire chapter will need fleshing out/rewording depending on the scope of each chapter.
\fi

Chapter one, as you may have just finished reading, contains the introduction to the project.
This has hopefully given you, the reader, the modern and historical context of the problem of interest.

The focus of chapter two is to develop the mathematical context of the problem.
Here we will give the necessary mathematical overview and description of the 

Chapter three aims to cover the finite element method in sufficient detail 
Also covered are relevant references to the FEM implementation within \oomph.
That is to say, how is the mathematical description of FEM transferred to an object-oriented code able to solve PDEs numerically.

Chapter four will cover the mathematics of multigrid.

Finally, the project will end with a discussion of the results and concluding remarks in chapters six and seven.
Here, a summary of findings and an overview of the work completed in the project will be given.
