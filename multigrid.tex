\section{Multigrid methods}

Multigrid refers to a family of methods which use multiple grid levels in order to achieve high rates of convergence to solve linear systems.
Iteration converges rapidly for error components whose frequency components are high.
Conversely, iteration is slow for error components with low frequency components.
By transferring the residual to a coarser grid, the error components with low frequency in the fine grid have high frequency in the coarse grid.
Hence smoothing iterations converge rapidly for this new problem.
Now the solution is transferred back to the fine grid by interpolation and applying the coarse grid correction.

High frequency components of the error are damped rapidly by a smoother.
Low frequency components on a coarse mesh are high frequency, thus are damped rapidly by a smoother.

% Insert figure of error components for initial iteration phases, want to show low frequency errors are not dampened.
% Probably use a 1D Helmholtz problem to do this

The description above is the outline for the two-grid method, on which many other multgrid methods are based \cite{hackbusch}.
For instance, the MG V-cycle may be thought of as a recursive scheme by performing an additional two-grid iteration on each coarser grid.
In this sense, we move from a fine mesh to coarser and coarser grids by restriction until we may solve the system directly.
Then we move the solution back to the finest level by prolongation until we are at the desired mesh level. 

For the finite element method to be compatible with multigrid, several components must exist.
Firstly, a hierarchy of meshes that define the multiple levels of the method, as well as transfer operators between the levels.
Next, on each level of the mesh, the Jacobian matrix resulting from the finite element discretisation must be formed in order to solve the problem at that level.
Finally, there must be  a suitable smoothing iteration procedure on each level.
In our case, this is FGMRES, however any appropriate iterative solver will be sufficient.

% Insert figures of the grid hierarchy for 2-grid, V-cycle, etc.
% Insert figure for how the frequencies decay based on mesh level.


\section{Grid hierarchy}

We will restrict our discussion to uniform structured grids in order to focus on the details of multigrid.
Mathematically, we require only the grid hierarchy so the specific internals of the individual grids is a technical detail that we will omit. 

% We want to discuss how the grid hierarchy is computed and used within oomph-lib.
The grid hierarchy used by multigrid in \oomph is generated by... 




\section{Multigrid as a preconditioner}

\subsection{Preconditioning}
% General talk about preconditioning
We want to solve the linear system
\begin{align}
	A x = b.
\end{align}
Direct methods are too costly to use since in general, the dimension of the problem is large.
Iterative methods, such as Krylov subspace methods, are a good alternative to use.
However the performance of such methods is poor without a preconditioner.
Hence, we would like a method that improves the performance of the iterative method.


Applying a preconditioning matrix $P$ on the left, we have
\begin{align}
	P^{-1} A x = P^{-1} b \label{eqn:precond}
\end{align}
which solves the above system exactly for the case $P=A^{-1}$. 
This is optimal as it solves the original problem, however it is costly to obtain.
Instead, we would like a alternative such that $P$ is cheap to find and the preconditioned system \eqref{eqn:precond} is easier to solve than the original problem.


Many general preconditioning techniques have been developed that work for a wide variety of problems.
For example, preconditioning matrices based on the splitting of the matrix $A$ are simple to use and cheap to compute.
More specific preconditioning techniques have been developed in the case of certain problems.
These tend to be more complicated to use, but often will come with better performance.
As a first attempt, it is a good idea to use a simple method to see the impact on the convergence times.
Only in the case where optimisation is crucial to the problem or a general preconditioner does not work, a specific preconditioner should be developed.



\subsection{Block preconditioning}

% Talk about block preconditioning in regards to complex Helmholtz problem
% The block structure, derivation...


\subsection{Multigrid preconditioning}

As an alternative to using multigrid as an iterative solver, it is possible to instead perform multigrid iterations to partially solve the linear system, then perform a solve with an additional linear solver on the preconditioned system.
This gives an effective method  

On its own, the linear solver is not as effective as the preconditioned linear solver.



We reduce the tolerance of the mg solver and 


