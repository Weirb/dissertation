\chapter{Results}

\def\figwidth{0.7\columnwidth}


What results did we gather?
What machine did we use?

Need a general discussion for each

Increasing $N$ causes issues for both multigrid and superlu.
Multigrid behaves worse, but both still don't work.
Can rectify this by shifting the computational domain away from the $z$-axis.


Solutions below were found on a square domain, $[1,2]\times [1,2]$.

\begin{figure}
    \centering

    \begin{tikzpicture}
    \centering
    \begin{loglogaxis}[
    xlabel={Degrees of freedom},
    ylabel={Time taken to solve (s)},
    grid=major,
    width=\figwidth
    ]
    
    \addplot [color=black] table [x index=1, y index=0] {data/helmholtz_mg_time.dat};
    \addlegendentry{Multigrid}

    \addplot [color=red] table [x index=1, y index=0] {data/helmholtz_superlu_time.dat};
    \addlegendentry{SuperLU}

    \end{loglogaxis}
    \end{tikzpicture}
    \caption{Time taken to solve the Helmholtz equation with $k=100$ and $N=5$.}
\end{figure}






\begin{figure}
    \centering

    \begin{tikzpicture}
        \centering
    \begin{loglogaxis}[
    xlabel={$h$},
    ylabel={Error},
    xmin=0.01, xmax=1.1,
    grid=major,
    width=\figwidth
    % /pgfplots/log ticks with fixed point,
    ]
    
    \addplot [only marks,fill=black] table {poisson.dat};

    \addplot table[y={create col/linear regression={y=1}}] {poisson.dat} 
    coordinate [pos=0.8] (A)
    coordinate [pos=0.3] (B);

    \xdef\slope{\pgfplotstableregressiona} % save the slope parameter
    \draw (B) -| (A)  % draw the opposite and adjacent sides of the triangle
    node [pos=0.25, anchor=south] {1} % label the horizontal line
    node [pos=0.75,anchor=east] {\pgfmathprintnumber{\slope}} %label the vertical line
    ;

    % \addlegendentry{$\pgfmathprintnumber{\pgfplotstableregressiona}$}

    \end{loglogaxis}
    \end{tikzpicture}
    \caption{Solving the Poisson problem with multigrid, $k=0,N=3$.}
\end{figure}


\begin{figure}
    \centering

    \begin{tikzpicture}
        \centering
    \begin{loglogaxis}[
    xlabel={$h$},
    ylabel={Error},
    xmin=0.01, xmax=1.1,
    grid=major,
    width=\figwidth
    % /pgfplots/log ticks with fixed point,
    ]
    
    \addplot [only marks,fill=black] table {helmholtz.dat};

    \addplot table[y={create col/linear regression={y=1}}] {helmholtz.dat} 
    coordinate [pos=0.8] (A)
    coordinate [pos=0.3] (B);

    \xdef\slope{\pgfplotstableregressiona} % save the slope parameter
    \draw (B) -| (A)  % draw the opposite and adjacent sides of the triangle
    node [pos=0.25, anchor=south] {1} % label the horizontal line
    node [pos=0.75,anchor=east] {\pgfmathprintnumber{\slope}} %label the vertical line
    ;

    % \addlegendentry{$\pgfmathprintnumber{\pgfplotstableregressiona}$}

    \end{loglogaxis}
    \end{tikzpicture}
    \caption{Solving the Helmhotlz problem with multigrid, $k=10,N=3$.}
\end{figure}